Two Sided Marketplace Course from Codeplace, on Rails 5

1
gem install rails
rails -v // 5.02

2
rails new estuk // estuk/ folder created, 
    how to run rails 5 on c9.io?

3
cd estuk; rails server -b $IP -p $PORT; 
    it's running, how to get to it?
click on 'Share' next to gear in c9 workspace, copy the 2nd link, paste in new tab and run

4
SAVE FIRST COMMIT: 
    git init; git add --all; git commit; (not passing -m will open the nano editor to add the commit message)
    type the commit message
    CTRL O; [ENTER]; CTRL X (save the message; confirm command; exit nano editor)
    
5
ADD REMOTE REPOSITORY:
    In github, click new repository, give it a good name and description, then:
    git remote add origin https://github.com/ImsirovicAjdin/codeplace-two.git
    git push -u origin master
6
ADD BOOTSTRAP
sourcecode: 
    https://github.com/seyhunak/twitter-bootstrap-rails
add bootstrap gem: 
    gem 'twitter-bootstrap-rails', :git => 'git://github.com/seyhunak/twitter-bootstrap-rails.git'
run bundle install: 
    bundle install
run the generator:
    rails generate bootstrap:install static
git commit:
    git add --all; git commit -m "Add bootstrap"; git push -u origin master
    
7
INSTALL SIMPLEFORM
source:
    https://github.com/plataformatec/simple_form
add simple_form gem:
    gem 'simple_form'
run the following command to install it:
    bundle install
Run the generator:
    rails generate simple_form:install --bootstrap
git commit:
    git add --all; git commit -m "Add simple_form"; git push -u origin master
    
8 
ADD OUR HOMEPAGE
"Before adding the user Authentication, it's a good idea to have at least one page in our application"
"Generate a controller called 'pages', with only one action -> 'home'
    rails generate controller pages home
"Replace the default route that was generated by the controller and replace it with the following root route":
    Rails.application.routes.draw do
        get 'pages/home'
        root 'pages#home # <-- THIS HERE!

9
TRY REFRESHING THE WEBSITE, YOU'LL GET THIS ERROR:
couldn't find file 'twitter-bootstrap-static/bootstrap' with type 'text/css'
FIX: Restart the server

10
ADD USERS
"We are going to use a really amazing gem for user authentication called: devise."
source:
    https://github.com/plataformatec/devise
add gem:
    gem 'devise'
install the gem:
    bundle install
run the generator for devise, as per the instructions from the documentation:
    rails generate devise:install
To finish up the devise installation, we need to setup the default mailer as per instructions on the terminal output.
    config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }
Create the views for the users:
    rails generate devise:views
Finally create the users by runnign the devise generator in the terminal:
    rails generate devise User
After the creation of the User table, migrate the db:
    rake db:migrate
Go to your website/users/sign_up (NOTE: YOU MUST RESTART THE SERVER)
git add --all; git commit -m "Add devise"; git push -u origin master

11
ADD THE HEADER
Bootstrap navbar section:
    http://getbootstrap.com/components/#navbar
Copy the html, add it to _header.html.erb.
    app/views/layouts/_header.html.erb
Render the partial by adding it to application.html.erb:
    just above the yield stmt, inside the body tags
Go to your webpage, F12, remove redundant elements.
    when you done, copy the remaining navbar into _header.
git add --all; git commit -m "Add blank navbar"; git push -u origin master

12
ADD THE DYNAMIC LINKS
Based on whether or not the user is logged in, add the dynamic links to the navbar.

13
ADD THE JUMBOTRON
Navigate and copy:
    http://getbootstrap.com/components/#jumbotron
Add it to homepage:
    ./app/views/pages/home.html.erb
git add --all; git commit -m "Add jumbotron"; git push -u origin master

14
MAKE DEVISE VIEWS LOOK NICER
Create a stylesheet named devise.css.scss:
    ./app/assets/stylestheets/devise.css.scss
Apply the created classes to your sign_in form:
    .app/views/devise/sessions/new.html.erb
The same for the sign_up form:
    ./app/views/devise/registrations/new.html.erb
The same for the reset_password form:
    ./app/views/devise/passwords/new.html.erb
The same for the edit/registrations page:
    ./app/views/devise/registrations/edit.html.erb
Activate client side validation on the simple_form initializer:
    ./app/config/initializers/simple_form.rb
git add --all; git commit -m "Make devise look better"; git push origin master

15
GENERATING BOOKS

With one command we can create the whole book scaffold, it's gonna generate all.
First we gonna think what kind of attributes a book will have:
    name, author name, description, 2 attachments, 1 preview and 1 resource, & price.
We're gonna use stripe, and stripe uses a price in cents. $1 = 100 cents.
SCAFFOLD THE BOOK, start with basic attribs, l8tr we'll add more fields
    rails generate scaffold book name:string author:string description:text price:integer availability:boolean
BEFORE RUNNING THE MIGRATION, SET availability FIELD DEFAULT VALUE TO TRUE
    ./db/migrate/...create_books.rb
        t.boolean :availability, default: true
INSIDE views/books, DELETE index.json.builder and show.json.builder (we don't need these files)
NOW MIGRATE THE DB, this command will create a table named "Books" with 5 columns: name, author, description, price, availability
    rake db:migrate
THE SCAFFOLD CREATED A CSS FILE WE DON'T NEED, DELETE IT
    (X) scaffold.scss
ADD THE books_path TO OUR VIEWS in _header
    ./app/views/layouts/_header.html.erb
ADD THE books_path TO HOMEPAGE TOO
    <% link_to "Books", books_path, class: "btn btn-primary" %>
IN OUR pages_controller, ENSURE THE current_user IS REDIRECTED TO THE books_path
GIT ADD, COMMIT "Add the books scaffold", PUSH

16
CUSTOMIZING THE BOOK SHOW
The target is to customize the way a book looks

CREATE A NEW BOOK
    website/books/new # 'add the book'
REMOVE THE GENERATED HTML FOR THE BOOKS SHOW PAGE
    ./app/views/books/show.html.erb
AND REPLACE IT WITH 2 BOOTSTRAP COLUMNS
    .container>.row>.col-md-6+.col-md-6
COPY AN IMG FILE, PLACE IT AS "book.jpg" in app/assets/images
ON THE 1st COL, MAKE image_tag FOR THE BOOK COVER
    ./app/views/books/show.html.erb
ON THE 2nd COL, DISPLAY ALL THE BOOK'S ATTRIBUTES
GIT ADD, COMMIT "Make Show book page look better", PUSH

17
IMPROVING THE BOOKS INDEX
Target: Improve index page using a partial.

DELETE ALL BOOK INDEX PAGE CONTENT
    ./app/views/books/index.html.erb
ADD BOOTSTRAP-READY CODE in ./app/views/books/index.html.erb
    .row>.col-md-3>.thumbnail...
OPEN THE BOOKS PAGE
    website/books
ADD THE BOOKS ATTRIBUTES TO THE THUMBNAIL CAPTION
    test it with dummy content first
MAKE THE CONTENT DYNAMIC (PULL FROM DB)
    add book partial: "_book.html.erb" in app/views/books
RENDER THE PARTIAL FROM ./app/views/books/index.html.erb
    .row><% render @books %>
NOTE:
    Rails knows, that a partial corresponds to a collection. So you could use render @users, if there is a _user partial, or render @tasks with the corresponding _task partial, and rails with automatically render the partial for each book/task/user in the books/tasks/users variable.
    
On the books_controller, the index action, the @books variable holds the collection of all books. 
Now update the _book.html.erb partial with the properties of the book.
      <p><strong><%= book.name %></strong></p>
      <p><%= book.price.to_f / 100 %></p>
We want to image to be 'clickable' and point to that book, so let's update the partial once more.
    - Make a link_to block containing all the image element, so everything inside the block will link to the book_path.
    - And add a link_to statement to the title of the book to.
Add an extra book, just to check if everything works fine.
    Before you save it, uncheck the available checkbox, to state the book is unavailable.
    the second book is still showing up, while the state of the book is unavailable. Let's fix this.
To fix the index page, and have it showing only the available books, we are going to change the index action in the BooksController.
Open the BooksController, and look for the index action, there you see that the @books variable holds all the Book(s) because of Book.all.
    CHANGE IT TO Book.where(availability: true)
Perfect! 
Now go to your localhost:3000/books  and notice that only the books available are shown in the index page!

GIT ADD, COMMIT "Make the Books index design look better", PUSH

18
IMPROVING THE BOOKS NEW AND EDIT
localhost:3000/books/new, we want to redesign this form
(A) Both the NEW and the EDIT action render the same form from within their views.
Open up the books/edit page, and the books/new page to check it out. 
So if we want to edit the design for these pages, we have to edit the _form.html.erb partial that is rendered in these pages.
(B) Now open up the books/_form.html.erb partial, to add classes and make it look and work better. We are also going to add 'validations' to the input fields.
        ./app/views/books/_form.html.erb
    Inspect the current changes to the form at localhost:3000/books/new
(C)  It already looks much better, but we can do a bit more. 
- Remove the surrounding <div> with the class of 'from-inputs'.
- Add a <br> line below the description to add some space between the price and description. 
- Add a <div> around the availability checkbox  with the bootstrap classes: 'checkbox' and 'text-center'.
- Remove the label from the checkbox, by adding the 'label: false' statement, and put the required validation label to false. 
(D) As a finishing touch, open up the books/new and books/edit views again, and add a text-center class to the h1 title.
        ./app/views/books/new.html.erb
GIT ADD, COMMIT "Make the New and Edit view look better", PUSH

19





